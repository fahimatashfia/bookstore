<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shopping Cart - StoryStack</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <h1>StoryStack</h1>
        <nav>
          <a href="index.html">Home</a>
          <a href="products.php">Browse Books</a>
          <a href="cart.html">Cart (<span id="cart-count">0</span>)</a>
        </nav>
      </header>

      

      <main class="welcome-section">
        <h2>ðŸ›’ Your Shopping Cart</h2>

        <div id="cart-container">
          <!-- Cart items will be loaded here -->
        </div>

        <div id="cart-summary" style="display: none">
          <div class="cart-summary">
            <h3>Order Summary</h3>
            <div class="summary-row">
              <span>Subtotal:</span>
              <span id="subtotal">$0.00</span>
            </div>
            <div class="summary-row total">
              <span>Total:</span>
              <span id="total">$0.00</span>
            </div>
            <a
              href="checkout.html"
              class="btn btn-primary"
              style="display: block; text-align: center; margin-top: 20px"
              >Proceed to Checkout</a
            >
          </div>
        </div>
      </main>

      <footer>
        <p>&copy; 2025 StoryStack - Bookstore. All rights reserved.</p>
      </footer>
    </div>

    <script>
      function getCart() {
        return JSON.parse(localStorage.getItem("cart")) || [];
      }

      function saveCart(cart) {
        localStorage.setItem("cart", JSON.stringify(cart));
        updateCartCount();
      }

      function updateCartCount() {
        const cart = getCart();
        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
        document.getElementById("cart-count").textContent = totalItems;
      }

      function displayCart() {
        const cart = getCart();
        const container = document.getElementById("cart-container");
        const summary = document.getElementById("cart-summary");

        if (cart.length === 0) {
          container.innerHTML = `
                    <div class="empty-state">
                        <h3>Your cart is empty</h3>
                        <p class="empty-state-paragraph">Browse our collection and add some books!</p>
                        <a href="products.php" class="btn btn-primary">Browse Books</a>
                    </div>
                `;
          summary.style.display = "none";
          return;
        }

        let html = '<div class="cart-items">';
        let total = 0;

        cart.forEach((item, index) => {
          const itemTotal = item.price * item.quantity;
          total += itemTotal;

          html += `
                    <div class="cart-item">
                        <div class="cart-item-info">
                            <h3>${item.title}</h3>
                            <p>${item.category}</p>
                            <p class="product-price">$${item.price.toFixed(
                              2
                            )}</p>
                        </div>
                        <div class="cart-item-actions">
                            <div class="quantity-controls">
                                <button onclick="updateQuantity(${index}, -1)">-</button>
                                <span>${item.quantity}</span>
                                <button onclick="updateQuantity(${index}, 1)">+</button>
                            </div>
                            <div>
                                <strong>$${itemTotal.toFixed(2)}</strong>
                            </div>
                            <button class="remove-btn" onclick="removeItem(${index})">Remove</button>
                        </div>
                    </div>
                `;
        });

        html += "</div>";
        container.innerHTML = html;

        // Update summary
        document.getElementById("subtotal").textContent =
          "$" + total.toFixed(2);
        document.getElementById("total").textContent = "$" + total.toFixed(2);
        summary.style.display = "block";
      }

      function updateQuantity(index, change) {
        let cart = getCart();
        cart[index].quantity += change;

        if (cart[index].quantity <= 0) {
          cart.splice(index, 1);
        }

        saveCart(cart);
        displayCart();
      }

      function removeItem(index) {
        let cart = getCart();
        cart.splice(index, 1);
        saveCart(cart);
        displayCart();
      }

      // Initialize
      updateCartCount();
      displayCart();
    </script>
  </body>
</html>